import{d as B,r as p,c as M,l as E,m as S,o as d,w as n,e as b,u as m,b as r,i as k,p as I,a as u,g as c,q as g,n as v,v as f,t as y}from"./app-CAyZZdkS.js";import{Y as D,h as w,G as N,V as $,S as A,r as P}from"./researcherService-DunJD6IL.js";const U={class:"fixed inset-0 z-10 overflow-y-auto"},F={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},H={class:"mt-3 text-center sm:mt-5"},O={class:"mt-1"},R=["value"],T={class:"mt-1"},G={key:0,class:"mt-2 text-sm text-red-600"},Y={class:"mt-1"},q={key:0,class:"mt-2 text-sm text-red-600"},L={class:"mt-1"},J={key:0,class:"mt-2 text-sm text-red-600"},K={class:"mt-1"},Q={key:0,class:"mt-2 text-sm text-red-600"},W={key:0,class:"bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-md p-3"},X={class:"flex"},Z={class:"ml-3"},ee={class:"mt-1 text-sm text-red-700 dark:text-red-300"},re={class:"mt-6 sm:mt-8 sm:grid sm:grid-flow-row-dense sm:grid-cols-2 sm:gap-3"},te=["disabled"],ae={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24"},se=["disabled"],de=B({__name:"EditModal",props:{show:{type:Boolean},researcher:{}},emits:["close","updated"],setup(h,{emit:_}){const l=h,C=_,a=p({given_names:"",family_name:"",primary_email:"",keywords:[]}),i=p(!1),t=p({}),x=M({get:()=>a.value.keywords.join(", "),set:s=>{a.value.keywords=s.split(",").map(e=>e.trim()).filter(e=>e.length>0)}}),V=()=>{l.researcher&&(a.value={given_names:l.researcher.given_names||"",family_name:l.researcher.family_name||"",primary_email:l.researcher.primary_email||"",keywords:[...l.researcher.keywords]}),t.value={}},z=()=>(t.value={},a.value.primary_email&&a.value.primary_email.trim()&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.value.primary_email)?(t.value.primary_email="Formato de email inválido",!1):!0),j=async()=>{if(l.researcher&&z()){i.value=!0,t.value={};try{await P.update({orcid:l.researcher.orcid,given_names:a.value.given_names.trim()||void 0,family_name:a.value.family_name.trim()||void 0,primary_email:a.value.primary_email.trim()||void 0,keywords:a.value.keywords.length>0?a.value.keywords:void 0}),C("updated")}catch(s){t.value.general=s.message}finally{i.value=!1}}};return E([()=>l.show,()=>l.researcher],([s,e])=>{s&&e&&V()},{immediate:!0}),(s,e)=>(d(),S(m(A),{show:s.show,as:"template"},{default:n(()=>[b(m(D),{as:"div",class:"relative z-50",onClose:e[5]||(e[5]=o=>s.$emit("close"))},{default:n(()=>[b(m(w),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:n(()=>e[6]||(e[6]=[r("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)])),_:1,__:[6]}),r("div",U,[r("div",F,[b(m(w),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:n(()=>[b(m(N),{class:"relative transform overflow-hidden rounded-xl bg-white px-4 pb-4 pt-5 text-left shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6 dark:bg-gray-800"},{default:n(()=>[r("div",null,[e[9]||(e[9]=r("div",{class:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-800 dark:to-blue-700"},[r("svg",{class:"h-6 w-6 text-blue-600 dark:text-blue-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})])],-1)),r("div",H,[b(m($),{as:"h3",class:"text-lg font-semibold leading-6 text-gray-900 dark:text-white"},{default:n(()=>e[7]||(e[7]=[k(" Editar Investigador ",-1)])),_:1,__:[7]}),e[8]||(e[8]=r("div",{class:"mt-2"},[r("p",{class:"text-sm text-gray-600 dark:text-gray-300"}," Modifica la información del investigador. El ORCID no se puede cambiar una vez registrado. ")],-1))])]),r("form",{onSubmit:I(j,["prevent"]),class:"mt-6 space-y-5"},[r("div",null,[e[10]||(e[10]=r("label",{for:"orcid",class:"block text-sm font-semibold text-gray-700 mb-2 dark:text-gray-200"}," ORCID ",-1)),r("div",O,[r("input",{id:"orcid",value:s.researcher?.orcid,type:"text",disabled:"",class:"block w-full rounded-lg border-gray-300 bg-gray-50 shadow-sm sm:text-sm font-mono px-4 py-3 text-gray-500 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400"},null,8,R)]),e[11]||(e[11]=r("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"El ORCID no se puede modificar",-1))]),r("div",null,[e[12]||(e[12]=r("label",{for:"given_names",class:"block text-sm font-semibold text-gray-700 mb-2 dark:text-gray-200"}," Nombres ",-1)),r("div",T,[g(r("input",{id:"given_names","onUpdate:modelValue":e[0]||(e[0]=o=>a.value.given_names=o),type:"text",class:v(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-4 py-3 transition-colors duration-200 bg-white text-gray-900 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:focus:border-blue-400 dark:focus:ring-blue-400",{"border-red-300 text-red-900 placeholder-red-300 focus:border-red-500 focus:ring-red-500 dark:border-red-500 dark:text-red-300":t.value.given_names}])},null,2),[[f,a.value.given_names]])]),t.value.given_names?(d(),u("p",G,y(t.value.given_names),1)):c("",!0)]),r("div",null,[e[13]||(e[13]=r("label",{for:"family_name",class:"block text-sm font-semibold text-gray-700 mb-2 dark:text-gray-200"}," Apellidos ",-1)),r("div",Y,[g(r("input",{id:"family_name","onUpdate:modelValue":e[1]||(e[1]=o=>a.value.family_name=o),type:"text",class:v(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-4 py-3 transition-colors duration-200 bg-white text-gray-900 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:focus:border-blue-400 dark:focus:ring-blue-400",{"border-red-300 text-red-900 placeholder-red-300 focus:border-red-500 focus:ring-red-500 dark:border-red-500 dark:text-red-300":t.value.family_name}])},null,2),[[f,a.value.family_name]])]),t.value.family_name?(d(),u("p",q,y(t.value.family_name),1)):c("",!0)]),r("div",null,[e[14]||(e[14]=r("label",{for:"primary_email",class:"block text-sm font-semibold text-gray-700 mb-2 dark:text-gray-200"}," Email Principal ",-1)),r("div",L,[g(r("input",{id:"primary_email","onUpdate:modelValue":e[2]||(e[2]=o=>a.value.primary_email=o),type:"email",class:v(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-4 py-3 transition-colors duration-200 bg-white text-gray-900 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:focus:border-blue-400 dark:focus:ring-blue-400",{"border-red-300 text-red-900 placeholder-red-300 focus:border-red-500 focus:ring-red-500 dark:border-red-500 dark:text-red-300":t.value.primary_email}])},null,2),[[f,a.value.primary_email]])]),t.value.primary_email?(d(),u("p",J,y(t.value.primary_email),1)):c("",!0)]),r("div",null,[e[15]||(e[15]=r("label",{for:"keywords",class:"block text-sm font-semibold text-gray-700 mb-2 dark:text-gray-200"}," Palabras Clave ",-1)),r("div",K,[g(r("textarea",{id:"keywords","onUpdate:modelValue":e[3]||(e[3]=o=>x.value=o),rows:"4",placeholder:"Ingresa las palabras clave separadas por comas",class:v(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-4 py-3 transition-colors duration-200 bg-white text-gray-900 placeholder-gray-500 dark:bg-gray-800 dark:text-white dark:placeholder-gray-400 dark:border-gray-600 dark:focus:border-blue-400 dark:focus:ring-blue-400",{"border-red-300 text-red-900 placeholder-red-300 focus:border-red-500 focus:ring-red-500 dark:border-red-500 dark:text-red-300 dark:placeholder-red-400":t.value.keywords}])},null,2),[[f,x.value]])]),e[16]||(e[16]=r("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"Separa las palabras clave con comas (ej: inteligencia artificial, machine learning, datos)",-1)),t.value.keywords?(d(),u("p",Q,y(t.value.keywords),1)):c("",!0)]),t.value.general?(d(),u("div",W,[r("div",X,[e[18]||(e[18]=r("div",{class:"flex-shrink-0"},[r("svg",{class:"h-5 w-5 text-red-400 dark:text-red-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),r("div",Z,[e[17]||(e[17]=r("h3",{class:"text-sm font-medium text-red-800 dark:text-red-200"},"Error",-1)),r("div",ee,y(t.value.general),1)])])])):c("",!0),r("div",re,[r("button",{type:"submit",disabled:i.value,class:"inline-flex w-full justify-center rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 px-4 py-3 text-sm font-semibold text-white shadow-sm hover:from-blue-700 hover:to-blue-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600 disabled:opacity-50 disabled:cursor-not-allowed sm:col-start-2 transition-all duration-200"},[i.value?(d(),u("svg",ae,e[19]||(e[19]=[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):c("",!0),k(" "+y(i.value?"Actualizando...":"Actualizar Investigador"),1)],8,te),r("button",{type:"button",onClick:e[4]||(e[4]=o=>s.$emit("close")),disabled:i.value,class:"mt-3 inline-flex w-full justify-center rounded-lg bg-white px-4 py-3 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed sm:col-start-1 sm:mt-0 transition-colors duration-200"}," Cancelar ",8,se)])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}});export{de as _};
